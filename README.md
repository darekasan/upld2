# upld2
楽曲用アップローダー 自分用

### できること
- wavやmp3の他、一般的なオーディオを含むファイル(動画など)のアップロード
- サーバーサイドでAAC変換と波形画像生成
- 同期再生でみんなで一斉に聴ける(WebSocketで通信して複数端末で同時に再生できる)
- 投稿をSlackで通知

### 同期再生
サークルで楽曲品評会をインターネット越しにやる時に必要だったので作った。ファイルの選択、再生/停止、シークといった操作が全員に反映される。

### ファイル
|ファイル名|説明|
|----|----|
|ws_server/server.py|同期再生用のサーバー|
|post.php|アップロードするやつ|
|playlist.php|?filenum=1,2,3みたいな感じでファイル番号を渡すと連続再生ができる|
|preview.php|波形画像つきの再生画面|
|player.html|同期再生|
|filelist.php|ファイルリストがjsonで返ってくる|
|del.php|論理削除 ちゃんと動くのかわからん|
|common.php|共通の関数をまとめたやつ&設定値|
|log.txt|ログ|
|fileindex.txt|ファイルリスト(CSV)|


### 既知の問題（同期再生）
- 再生中に人が入ってくると勝手に先頭に戻される？
- 主従関係がないから誰でも操作できる（ホールド機能はつけた）
- ところどころ絶対パス指定だったりしてるので他所じゃ動かない(WORKS ON MY MACHINE)

### そのうちやること
- リファクタリングしたい（名前がひどすぎる）
- ファイルのリストをcsvじゃなくしたい
- playlist.phpをもう少しいい感じにする
- サーバーを1つのポートで複数セッションできるようにしたい